# 真实场景测试 - 智选电商平台

## 测试场景 1: 项目启动 - 任务分解

**场景**: 作为项目经理，我需要将整个电商平台项目分解为可管理的开发任务，以便团队进行开发。

**使用技能**: `/dnaspec.task-decomposer`

**输入内容**:
```
将智选电商平台的开发分解为具体任务。

项目概况：
- B2C电商平台
- 需要5个Epic：用户认证、商品浏览、购物车、订单管理、商家后台
- 技术栈：React + Node.js + PostgreSQL
- 团队规模：10人
- 开发周期：3个月

需求：
1. 前期需要搭建基础架构
2. 中期开发核心功能
3. 后期进行测试和优化

请按照开发优先级和依赖关系进行任务分解。
```

---

## 测试场景 2: 系统架构设计

**场景**: 作为系统架构师，我需要为智选电商平台设计高可用、可扩展的微服务架构。

**使用技能**: `/dnaspec.architect`

**输入内容**:
```
为智选电商平台设计系统架构。

关键需求：
- 支持10万并发用户
- 99.99%可用性
- 微服务架构
- 容器化部署

技术约束：
- 前端：React + TypeScript
- 后端：Node.js
- 数据库：PostgreSQL主从 + Redis缓存
- 消息队列：RabbitMQ

核心模块：
1. 用户服务
2. 商品服务
3. 订单服务
4. 支付服务
5. 库存服务

请设计服务拆分、数据流转、容错机制。
```

---

## 测试场景 3: 安全约束生成

**场景**: 作为安全工程师，我需要为支付模块生成安全约束和规则。

**使用技能**: `/dnaspec.constraint-generator`

**输入内容**:
```
为智选电商的支付模块生成安全约束。

支付场景：
- 支持微信支付、支付宝、信用卡
- 涉及敏感信息：银行卡号、CVV、有效期
- 需要符合PCI DSS标准
- 防范重放攻击、中间人攻击

关键要求：
1. 支付数据加密存储
2. 支付过程通信加密
3. 敏感信息脱敏展示
4. 支付超时控制（15分钟）
5. 支付幂等性保证

请生成具体的安全约束规则。
```

---

## 测试场景 4: 创建代码审查代理

**场景**: 作为技术负责人，我需要创建一个自动化的代码审查代理，帮助团队保证代码质量。

**使用技能**: `/dnaspec.agent-creator`

**输入内容**:
```
创建一个代码审查自动化代理。

代理职责：
- 审查Pull Request代码
- 检查代码规范（ESLint、Prettier）
- 检测安全问题（SQL注入、XSS）
- 评估代码复杂度
- 提供改进建议

技术栈：
- 前端：React + TypeScript
- 后端：Node.js + Express

代码规范：
- 遵循Airbnb风格指南
- 函数不超过50行
- 圈复杂度不超过10
- 必须编写单元测试

请创建这个代理的配置和规则。
```

---

## 测试场景 5: API接口验证

**场景**: 作为后端开发人员，我需要验证订单API的设计是否符合规范。

**使用技能**: `/dnaspec.dapi-checker`

**输入内容**:
```
验证订单REST API的设计规范。

API清单：
POST   /api/orders          - 创建订单
GET    /api/orders          - 订单列表
GET    /api/orders/:id      - 订单详情
PUT    /api/orders/:id      - 更新订单
DELETE /api/orders/:id      - 删除订单
POST   /api/orders/:id/pay  - 订单支付

设计考虑：
- 遵循RESTful规范
- 使用JWT认证
- 返回统一格式：{ code, message, data }
- 错误处理：4xx客户端错误、5xx服务端错误

请检查API设计是否符合规范。
```

---

## 测试场景 6: 代码模块化重构

**场景**: 作为高级工程师，我需要将现有的单体订单服务重构为模块化架构。

**使用技能**: `/dnaspec.modulizer`

**输入内容**:
```
将订单服务重构为模块化架构。

当前问题：
- 单体文件超过2000行
- 业务逻辑耦合严重
- 难以测试和维护
- 缺乏清晰的模块边界

订单服务当前包含：
- 订单创建逻辑
- 支付处理
- 库存扣减
- 物流对接
- 消息通知

重构目标：
1. 按业务领域拆分模块
2. 使用依赖注入
3. 清晰的模块接口
4. 便于单元测试

请提供模块化重构方案。
```

---

## 测试场景 7: 缓存策略优化

**场景**: 作为性能优化工程师，我需要为电商平台设计缓存策略以提升性能。

**使用技能**: `/dnaspec.cache-manager`

**输入内容**:
```
为智选电商设计缓存策略。

性能瓶颈：
- 商品详情页查询慢（500ms）
- 首页推荐加载慢（800ms）
- 热门商品库存查询压力大

缓存需求：
- 商品基本信息（名称、价格、图片）
- 商品库存状态
- 首页推荐列表
- 用户购物车

更新频率：
- 商品信息：变更较少
- 库存状态：高频变更
- 推荐列表：每小时更新
- 购物车：实时更新

请设计缓存方案，包括：
- 缓存粒度
- 过期策略
- 缓存更新机制
- 缓存穿透/雪崩防护
```

---

## 测试执行计划

## 测试顺序：
1. ✅ 场景1: 任务分解 - 项目启动阶段
2. ✅ 场景2: 架构设计 - 技术设计阶段
3. ✅ 场景3: 安全约束 - 需求分析阶段
4. ✅ 场景4: 创建代理 - 工程准备阶段
5. ✅ 场景5: API验证 - 开发阶段
6. ✅ 场景6: 模块化重构 - 优化阶段
7. ✅ 场景7: 缓存优化 - 性能调优阶段

## 测试方式：
使用 iflow CLI 实际调用这些命令，记录真实的输出结果。
