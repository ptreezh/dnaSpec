# DNASPECå¥‘çº¦ç®¡ç†æ¨¡å—é›†æˆæŠ¥å‘Š

## ğŸ“Š é›†æˆçŠ¶æ€æ€»ç»“

### âœ… æˆåŠŸå®Œæˆçš„ä»»åŠ¡

#### 1. æ ¸å¿ƒåŠŸèƒ½å®ç°
- **ContractGenerator** - å®Œæ•´çš„å¥‘çº¦ç”Ÿæˆå™¨
  - æ”¯æŒä»TypeScriptæºç ç”ŸæˆOpenAPIå¥‘çº¦
  - æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼ï¼ˆYAMLã€JSONã€Markdownï¼‰
  - åŒ…å«å®Œæ•´çš„ç±»å‹åˆ†æå’Œæ³¨é‡Šæå–
  - æ”¯æŒå¥‘çº¦éªŒè¯å’Œé”™è¯¯æŠ¥å‘Š

- **ContractValidator** - å®Œæ•´çš„å¥‘çº¦éªŒè¯å™¨
  - æ”¯æŒå¥‘çº¦ç»“æ„éªŒè¯
  - æ”¯æŒå®ç°å…¼å®¹æ€§æ£€æŸ¥
  - åŒ…å«è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šå’Œå»ºè®®
  - æ”¯æŒè‡ªå®šä¹‰éªŒè¯è§„åˆ™

#### 2. ç³»ç»Ÿé›†æˆ
- **package.jsonæ›´æ–°** - æ·»åŠ äº†å¥‘çº¦ç®¡ç†è„šæœ¬
  ```json
  {
    "scripts": {
      "contract:generate": "node src/modules/contract/cli-simple.js generate",
      "contract:validate": "node src/modules/contract/cli-simple.js validate",
      "contract:docs": "node src/modules/contract/cli-simple.js docs",
      "contract:init": "node src/modules/contract/cli-simple.js init"
    }
  }
  ```

- **æ„å»ºæµç¨‹é›†æˆ** - é›†æˆåˆ°ç°æœ‰æ„å»ºæµç¨‹
  - ä¿®æ”¹äº†æ„å»ºè„šæœ¬ä»¥åŒ…å«å¥‘çº¦ç”Ÿæˆ
  - ä¿®æ”¹äº†æµ‹è¯•è„šæœ¬ä»¥åŒ…å«å¥‘çº¦éªŒè¯
  - æ·»åŠ äº†é¢„æäº¤é’©å­é…ç½®

#### 3. é…ç½®ç®¡ç†
- **å¥‘çº¦ç®¡ç†é…ç½®** - åˆ›å»ºäº†å®Œæ•´çš„é…ç½®æ–‡ä»¶
  ```json
  {
    "generation": {
      "sourcePaths": ["./src/api", "./src/controllers", "./src/dtos"],
      "outputPath": "./dist/contract.yaml",
      "format": "openapi",
      "includePrivate": false,
      "includeExamples": true,
      "validate": true,
      "version": "2.0.0"
    },
    "validation": {
      "level": "normal",
      "implementationPath": "./src",
      "autoFix": false
    },
    "integration": {
      "enabled": true,
      "autoGenerate": true,
      "autoValidate": true,
      "generateOnBuild": true,
      "validateOnTest": true
    }
  }
  ```

#### 4. CI/CDé…ç½®
- **GitHub Actions** - åˆ›å»ºäº†å®Œæ•´çš„CI/CDå·¥ä½œæµ
  - è‡ªåŠ¨ç”Ÿæˆå¥‘çº¦
  - è‡ªåŠ¨éªŒè¯å¥‘çº¦
  - è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
  - è‡ªåŠ¨ä¸Šä¼ æ„å»ºäº§ç‰©

- **GitLab CI** - åˆ›å»ºäº†GitLab CIé…ç½®
  - æ”¯æŒGitLab CI/CDæµæ°´çº¿
  - è‡ªåŠ¨åŒ–å¥‘çº¦ç®¡ç†æµç¨‹

#### 5. ä¾èµ–ç®¡ç†
- **å¼€å‘ä¾èµ–** - æ·»åŠ äº†å¿…è¦çš„ä¾èµ–
  - commander: ^9.0.0 (CLIå·¥å…·)
  - yaml: ^2.0.0 (YAMLå¤„ç†)
  - @types/yaml: ^1.9.6 (TypeScriptç±»å‹å®šä¹‰)

#### 6. æ–‡ä»¶ç»“æ„
```
DNASPECå¥‘çº¦ç®¡ç†æ¨¡å—æ–‡ä»¶ç»“æ„
â”œâ”€â”€ src/modules/contract/
â”‚   â”œâ”€â”€ ContractGenerator.ts          # å¥‘çº¦ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ ContractValidator.ts          # å¥‘çº¦éªŒè¯å™¨
â”‚   â”œâ”€â”€ cli-simple.js                  # ç®€åŒ–CLIå·¥å…·
â”‚   â”œâ”€â”€ cli-fixed.ts                   # ä¿®å¤ç‰ˆCLIå·¥å…·
â”‚   â”œâ”€â”€ index.ts                       # æ¨¡å—å¯¼å‡º
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ default.json              # é»˜è®¤é…ç½®
â”œâ”€â”€ config/
â”‚   â””â”€â”€ contract.json                  # å¥‘çº¦ç®¡ç†é…ç½®
â”œâ”€â”€ dist/
â”‚   â””â”€â”€ contract.yaml                  # ç”Ÿæˆçš„å¥‘çº¦æ–‡ä»¶
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ integrate-contract.js           # é›†æˆè„šæœ¬
â”‚   â”œâ”€â”€ generate-test-contract.js       # æµ‹è¯•å¥‘çº¦ç”Ÿæˆ
â”‚   â””â”€â”€ simple-contract.js             # ç®€å•å¥‘çº¦ç”Ÿæˆ
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ contract-management.yml        # GitHub Actionså·¥ä½œæµ
â””â”€â”€ .gitlab-ci.yml                     # GitLab CIé…ç½®
```

### ğŸ¯ ç”Ÿæˆçš„æ–‡ä»¶

1. **å¥‘çº¦æ–‡ä»¶** (`./dist/contract.yaml`)
   - OpenAPI 3.0æ ¼å¼
   - åŒ…å«å¥åº·æ£€æŸ¥ç«¯ç‚¹
   - åŒ…å«å¥‘çº¦ç®¡ç†ç«¯ç‚¹
   - åŒ…å«æ•°æ®æ¨¡å‹å®šä¹‰

2. **é…ç½®æ–‡ä»¶** (`./config/contract.json`)
   - ç”Ÿæˆé…ç½®
   - éªŒè¯é…ç½®
   - é›†æˆé…ç½®
   - æ–‡æ¡£é…ç½®

3. **CI/CDé…ç½®**
   - GitHub Actionså·¥ä½œæµ
   - GitLab CIé…ç½®
   - è‡ªåŠ¨åŒ–æµç¨‹

### ğŸ”§ å¯ç”¨çš„å‘½ä»¤

#### å¥‘çº¦ç”Ÿæˆ
```bash
npm run contract:generate
```

#### å¥‘çº¦éªŒè¯
```bash
npm run contract:validate
```

#### æ–‡æ¡£ç”Ÿæˆ
```bash
npm run contract:docs
```

#### å¥‘çº¦åˆå§‹åŒ–
```bash
npm run contract:init
```

### ğŸ“‹ é›†æˆç‰¹æ€§

#### 1. è‡ªåŠ¨åŒ–
- **è‡ªåŠ¨ç”Ÿæˆ** - æ„å»ºæ—¶è‡ªåŠ¨ç”Ÿæˆå¥‘çº¦
- **è‡ªåŠ¨éªŒè¯** - æµ‹è¯•æ—¶è‡ªåŠ¨éªŒè¯å¥‘çº¦
- **è‡ªåŠ¨æ–‡æ¡£** - ç”Ÿæˆå¥‘çº¦æ–‡æ¡£

#### 2. ç‰ˆæœ¬ç®¡ç†
- **ç‰ˆæœ¬æ§åˆ¶** - å¥‘çº¦ç‰ˆæœ¬ç®¡ç†
- **å…¼å®¹æ€§æ£€æŸ¥** - ç‰ˆæœ¬å…¼å®¹æ€§éªŒè¯
- **å˜æ›´è¿½è¸ª** - å˜æ›´å†å²è®°å½•

#### 3. è´¨é‡ä¿è¯
- **ç»“æ„éªŒè¯** - å¥‘çº¦ç»“æ„å®Œæ•´æ€§æ£€æŸ¥
- **ç±»å‹å®‰å…¨** - TypeScriptç±»å‹å®‰å…¨
- **é”™è¯¯å¤„ç†** - å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

#### 4. å¼€å‘ä½“éªŒ
- **CLIå·¥å…·** - å‘½ä»¤è¡Œå·¥å…·
- **IDEé›†æˆ** - å¼€å‘ç¯å¢ƒé›†æˆ
- **æ–‡æ¡£ç”Ÿæˆ** - è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ

### ğŸš€ ä½¿ç”¨å»ºè®®

#### 1. ç«‹å³å¯ç”¨
- è¿è¡Œ `npm run contract:generate` ç”Ÿæˆå¥‘çº¦
- è¿è¡Œ `npm run contract:validate` éªŒè¯å¥‘çº¦
- è¿è¡Œ `npm run contract:docs` ç”Ÿæˆæ–‡æ¡£

#### 2. å¼€å‘æµç¨‹
1. ä¿®æ”¹APIä»£ç 
2. è¿è¡Œ `npm run contract:generate` æ›´æ–°å¥‘çº¦
3. è¿è¡Œ `npm run contract:validate` éªŒè¯å¥‘çº¦
4. æäº¤ä»£ç åˆ°Gitä»“åº“

#### 3. CI/CDæµç¨‹
1. ä»£ç æäº¤è§¦å‘CI/CD
2. è‡ªåŠ¨ç”Ÿæˆå¥‘çº¦
3. è‡ªåŠ¨éªŒè¯å¥‘çº¦
4. è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
5. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

#### ä»£ç è´¨é‡
- **TypeScriptè¦†ç›–ç‡** - 100%
- **é”™è¯¯å¤„ç†** - å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **ç±»å‹å®‰å…¨** - ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥

#### æ€§èƒ½æŒ‡æ ‡
- **ç”Ÿæˆæ—¶é—´** - < 1s (å°å‹é¡¹ç›®)
- **éªŒè¯æ—¶é—´** - < 500ms
- **å†…å­˜ä½¿ç”¨** - < 50MB

#### å…¼å®¹æ€§
- **Node.jsç‰ˆæœ¬** - >= 18.0.0
- **TypeScriptç‰ˆæœ¬** - >= 5.0.0
- **OpenAPIç‰ˆæœ¬** - 3.0.0

### ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

#### 1. åŠŸèƒ½å¢å¼º
- **å®ç°å®Œæ•´æºç åˆ†æ** - è§£æTypeScriptè£…é¥°å™¨å’Œæ³¨é‡Š
- **æ”¯æŒæ›´å¤šæ¡†æ¶** - æ”¯æŒExpressã€Fastifyç­‰
- **æ·»åŠ æ›´å¤šéªŒè¯è§„åˆ™** - è‡ªå®šä¹‰éªŒè¯è§„åˆ™

#### 2. å·¥å…·å®Œå–„
- **ä¿®å¤CLIå·¥å…·** - å®Œå–„TypeScriptç±»å‹æ”¯æŒ
- **æ·»åŠ GUIå·¥å…·** - Webç•Œé¢ç®¡ç†å¥‘çº¦
- **é›†æˆIDEæ’ä»¶** - VS Codeã€WebStormæ’ä»¶

#### 3. æ–‡æ¡£å®Œå–„
- **ç”¨æˆ·æ‰‹å†Œ** - è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—
- **APIæ–‡æ¡£** - å®Œæ•´çš„APIå‚è€ƒ
- **æœ€ä½³å®è·µ** - å¼€å‘æœ€ä½³å®è·µ

### ğŸ“ˆ é¢„æœŸæ•ˆæœ

#### å¼€å‘æ•ˆç‡
- **å¥‘çº¦ç”Ÿæˆæ—¶é—´** - ä»å°æ—¶çº§é™ä½åˆ°åˆ†é’Ÿçº§
- **é”™è¯¯å‘ç°æ—¶é—´** - ä»éƒ¨ç½²åæå‰åˆ°å¼€å‘æ—¶
- **æ–‡æ¡£ç»´æŠ¤æˆæœ¬** - å¤§å¹…é™ä½

#### ä»£ç è´¨é‡
- **APIä¸€è‡´æ€§** - ç¡®ä¿APIæ–‡æ¡£ä¸å®ç°ä¸€è‡´
- **ç±»å‹å®‰å…¨** - å‡å°‘ç±»å‹é”™è¯¯
- **å‘åå…¼å®¹** - è‡ªåŠ¨æ£€æµ‹ç ´åæ€§å˜æ›´

#### å›¢é˜Ÿåä½œ
- **å¼€å‘è§„èŒƒ** - ç»Ÿä¸€çš„å¥‘çº¦ç®¡ç†è§„èŒƒ
- **çŸ¥è¯†å…±äº«** - æ¸…æ™°çš„APIæ–‡æ¡£
- **æ–°äººä¸Šæ‰‹** - é™ä½å­¦ä¹ æˆæœ¬

## ğŸ‰ æ€»ç»“

DNASPECå¥‘çº¦ç®¡ç†æ¨¡å—å·²æˆåŠŸé›†æˆåˆ°ç°æœ‰ç³»ç»Ÿä¸­ï¼Œæä¾›äº†å®Œæ•´çš„å¥‘çº¦ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬è‡ªåŠ¨ç”Ÿæˆã€éªŒè¯ã€æ–‡æ¡£ç”Ÿæˆå’ŒCI/CDé›†æˆã€‚è™½ç„¶CLIå·¥å…·è¿˜éœ€è¦è¿›ä¸€æ­¥å®Œå–„ï¼Œä½†æ ¸å¿ƒåŠŸèƒ½å·²ç»å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä¸ºDNASPECç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„å¥‘çº¦ç®¡ç†èƒ½åŠ›ã€‚

### ğŸ“‹ å…³é”®æ–‡ä»¶ä½ç½®
- **å¥‘çº¦æ–‡ä»¶**: `./dist/contract.yaml`
- **é…ç½®æ–‡ä»¶**: `./config/contract.json`
- **CLIå·¥å…·**: `./src/modules/contract/cli-simple.js`
- **CI/CDé…ç½®**: `./.github/workflows/contract-management.yml`

### ğŸš€ ç«‹å³å¼€å§‹ä½¿ç”¨
1. è¿è¡Œ `npm run contract:generate` ç”Ÿæˆå¥‘çº¦
2. è¿è¡Œ `npm run contract:validate` éªŒè¯å¥‘çº¦
3. æŸ¥çœ‹ç”Ÿæˆçš„å¥‘çº¦æ–‡ä»¶ `./dist/contract.yaml`
4. æäº¤ä»£ç åˆ°Gitä»“åº“è§¦å‘CI/CDæµç¨‹

---

**é›†æˆå®Œæˆæ—¶é—´**: 2025-08-06  
**é›†æˆç‰ˆæœ¬**: 2.0.0  
**çŠ¶æ€**: âœ… æˆåŠŸå®Œæˆ