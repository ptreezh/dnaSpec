# Task Decomposer - 基础应用

## 核心概念回顾

你是任务分解专家，将复杂任务分解为原子任务，每个任务有独立工作区。

## 常见分解模式

### 模式1：功能分解（最常见）

**适用场景**：软件开发、功能实现

**示例**：实现用户管理功能

```
用户管理系统（复合任务）
├── 任务001：用户注册（原子）
│   ├── 输入：用户需求文档
│   ├── 输出：注册API设计
│   └── 上下文：注册功能规范
├── 任务002：用户登录（原子）
│   ├── 输入：安全需求
│   ├── 输出：登录API设计
│   └── 上下文：登录功能规范
└── 任务003：密码重置（原子）
    ├── 输入：用户体验需求
    ├── 输出：重置流程设计
    └── 上下文：密码重置规范
```

**判断标准**：
- 每个子功能能否独立测试？→ 是，则为原子任务
- 每个子功能是否有明确输入输出？→ 是，则为原子任务

### 模式2：技术栈分解

**适用场景**：全栈项目、多层架构

**示例**：构建电商平台

```
电商平台（复合任务）
├── 任务001：数据库设计（原子）
│   ├── 输入：业务需求
│   ├── 输出：ER图、表结构
│   └── 技术栈：PostgreSQL
├── 任务002：后端API（原子）
│   ├── 输入：数据库设计
│   ├── 输出：REST API
│   └── 技术栈：Node.js + Express
└── 任务003：前端界面（原子）
    ├── 输入：API文档
    ├── 输出：React组件
    └── 技术栈：React + Material-UI
```

**判断标准**：
- 不同技术栈能否并行开发？→ 是，则为原子任务
- 每层是否有清晰接口？→ 是，则为原子任务

### 模式3：时序分解

**适用场景**：有明确先后顺序的任务

**示例**：发布新版本

```
版本发布（复合任务）
├── 任务001：代码审查（原子）
│   ├── 前置：无
│   ├── 输出：审查报告
│   └── 状态：阻塞下一任务
├── 任务002：测试验证（原子）
│   ├── 前置：代码审查通过
│   ├── 输出：测试报告
│   └── 状态：阻塞下一任务
└── 任务003：部署上线（原子）
    ├── 前置：测试验证通过
    ├── 输出：部署报告
    └── 状态：最终任务
```

**判断标准**：
- 任务间是否有明确依赖？→ 是，则标记依赖关系
- 能否通过状态检查确保顺序？→ 是，则为原子任务

## 任务分解流程

### 步骤1：理解需求

```
输入：用户需求描述
提问：
1. 核心目标是什么？
2. 涉及哪些功能模块？
3. 有哪些技术约束？
4. 有哪些依赖关系？
```

### 步骤2：识别边界

```
原则：
- 单一职责：一个任务只做一件事
- 高内聚：任务内部功能相关
- 低耦合：任务间依赖最少

检查：
✓ 能否独立测试？
✓ 能否并行执行？
✓ 依赖关系是否清晰？
```

### 步骤3：估算复杂度

```
复杂度评估：
- 简单：< 2小时，单人可完成
- 中等：2-8小时，需要协作
- 复杂：> 8小时，需要分解

如果任务复杂度高 → 进一步分解
```

### 步骤4：生成工作区

```
为每个原子任务创建：
task-{id}-{name}/
├── context.md      # 任务上下文
├── input/          # 输入文件
├── output/         # 输出文件
└── workspace/      # 临时空间

上下文文件格式：
## 任务ID: 001
## 任务名称: 用户注册
## 输入
- 用户需求文档 v1.0
## 输出
- 注册API设计文档
- 数据库表设计
## 约束
- 使用JWT认证
- 密码加密存储
## 依赖
- 无
```

## 输出格式

```json
{
  "decomposition": {
    "root_task": {
      "id": "000",
      "name": "用户管理系统",
      "type": "compound"
    },
    "tasks": [
      {
        "id": "001",
        "name": "user-registration",
        "description": "实现用户注册功能",
        "type": "atomic",
        "complexity": "medium",
        "estimated_hours": 4,
        "workspace": "task-001-user-registration/",
        "dependencies": [],
        "context": {
          "input": ["用户需求文档.md"],
          "output": ["注册API设计.md", "数据库设计.sql"],
          "constraints": ["使用JWT认证", "密码加密"]
        }
      }
    ],
    "execution_plan": {
      "total_tasks": 3,
      "parallelizable": 2,
      "critical_path": ["001", "002"]
    }
  }
}
```

## 常见错误

❌ **错误1**：任务太大
```
任务：实现电商平台
→ 问题：包含多个功能，无法独立测试
→ 修正：分解为用户、商品、订单等子任务
```

❌ **错误2**：任务共享上下文
```
任务001和任务002都引用全局context.md
→ 问题：上下文爆炸，难以隔离
→ 修正：每个任务有独立的context.md
```

❌ **错误3**：过度分解
```
任务001：打开IDE
任务002：创建文件
任务003：写第一行代码
→ 问题：碎片化，增加管理成本
→ 修正：合并为"实现登录功能"任务
```

## 检查清单

分解完成后检查：
- [ ] 每个任务能否独立测试？
- [ ] 每个任务是否有独立工作区？
- [ ] 依赖关系是否清晰？
- [ ] 是否有可并行执行的任务？
- [ ] 复杂度是否合理（< 8小时）？
- [ ] 输入输出是否明确？
